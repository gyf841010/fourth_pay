<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
    <meta name="renderer" content="webkit">
<title>商户注册 - <{$sitename}> - 支付技术服务商，让支付简单、专业、快捷！</title>
<link rel="SHORTCUT ICON" href="/Public/theme/view7/css/favicon.ico">
    <link rel="stylesheet" href="/Public/theme/view7/css/base.css">
    <link rel="stylesheet" href="/Public/theme/view7/css/login.css">
    <link rel="stylesheet" href="/Public/theme/view7/css/layui.css">
<style>
        .layui-form-checkbox {
            width: 14px;
            height: 14px;
            padding: 0;
            margin-right: 0;
            line-height: 0;
            top: -1px;
        }

        .layui-form-checkbox i {
            font-size: 13px;
            left: -9px;
            top: 7px;
        }
    .login {background:#4f5a67 !important;}
    </style>
  <script>
        if (window.top !== window.self) {
            window.top.location = window.location;
        }
    </script>
</head>

<body class="login">
<div class="login-bg"></div>
<h1 class="login-logo">
    <a href="/">
        <img src="<{$logo}>" style="height:60px;">
    </a>
</h1>
<div class="container login">
    <div class="line bouncein">
        <div class="xs6 xm4 xs3-move xm4-move">
            <div style="height:120px;"></div>
            <div class="media media-y margin-big-bottom">
            </div>
            <form action="<{$register_checkRegister}>" id="defaultForm" method="post" class="layui-form">
                <div class="panel loginbox">
                    <div class="text-center margin-big padding-big-top">
                        <div>
                      <img src="/Uploads/OK_Pay.png" style="height:70px;">
                        </div>
                        <h1 style="margin-top:10px;">用户注册</h1>
                    </div>
                    <div class="panel-body" style="padding:30px;padding-top:0;">
                        <div class="form-group">
                            <div class="field field-icon-right">
                                <input type="text" class="layui-input" required lay-verify="required" name="username"
                                       id="username" autocomplete="off"  readonly onfocus="this.removeAttribute('readonly');"   value=""  placeholder="请输入用户名"/>
                                <span class="icon icon-user margin-small"></span>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="field field-icon-right">
                                <input type="text" class="layui-input" required lay-verify="required|email" name="email"
                                       id="email" aria-required="true" autocomplete="new-password" placeholder="请输入注册邮箱地址"/>
                                <span class="icon icon-envelope margin-small"></span>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="field field-icon-right">
                                <input type="password" class="layui-input" required lay-verify="required"
                                       name="password" id="password" aria-required="true" autocomplete="new-password" placeholder="输入密码" />
                                <span class="icon icon-key margin-small"></span>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="field field-icon-right">
                                <input type="password" class="layui-input" required lay-verify="required"
                                       name="password" id="confirmpassword" aria-required="true" autocomplete="new-password" placeholder="确认密码"/>
                                <span class="icon icon-key margin-small"></span>
                            </div>
                        </div>
                      <if condition="$siteconfig['invitecode'] eq 1">
                      <div class="form-group">
                            <div class="field field-icon-right">
                                <input type="text" class="layui-input" required lay-verify="required"
                                       name="invitecode" id="invitecode" aria-required="true" autocomplete="new-password" placeholder="邀请码"/>
                            </div>
                        </div></if>
                      
                      
                        <!-- 增加合作协议 -->
                        <div class="form-group" style="margin-left:10px;">
                            <input type="checkbox" name="agreeBtn" title="" lay-skin="primary" checked> 我已同意协议
                            <a style="color:#0ae" href="javascript:void(0)" onclick="showAgree()">《<{$sitename}>业务合作协议》</a>
                        </div>
                        <div class="form-group">
                            <input type="button" id="regBtn" class="button button-block bg-main text-big input-big"
                                   value="注册" lay-filter="saveBtnLay" lay-submit="">
                        </div>
                        <div class="form-group register-now">
                            <div class="field">
                                <span>已有账号?</span>
                                <a href="<{$user_login}>" class="register-btn">立即登录</a>
                            </div>
                        </div>
                    </div>
                </div>
            </form>
            <div class="copy">
                <span><?php echo "Copyright © 2017-" . date("Y") . " "; ?><{$sitename}> Rights Reserved.</span>
            </div>
        </div>
    </div>
</div>
<script src="/Public/theme/view7/layui.all.js"></script>
  <script type="text/javascript">
function openKefuLink()
{
window.open("http://wpa.qq.com/msgrd?v=3&uin=<{$qq}>&site=qq&menu=yes",'_blank');
}

</script>
<!-- All Jquery -->
<!-- ============================================================== -->
<script src="Public/New/plugins/vendors/jquery/jquery.min.js"></script>
<!-- Bootstrap popper Core JavaScript -->
<script src="Public/New/plugins/vendors/bootstrap/js/popper.min.js"></script>
<script src="Public/New/plugins/vendors/bootstrap/js/bootstrap.min.js"></script>
<!-- slimscrollbar scrollbar JavaScript -->
<script src="Public/New/plugins/vendors/ps/perfect-scrollbar.jquery.min.js"></script>
<!--Menu sidebar -->
<script src="Public/New/assets/js/sidebarmenu.js"></script>
<!--Custom JavaScript -->
<script src="Public/New/assets/js/custom.min.js"></script>
<script src="Public/Front/js/plugins/layui/layui.js" charset="utf-8"></script>
<script>
    function checkEmail(email){
        var myReg=/^[a-zA-Z0-9_-]+@([a-zA-Z0-9]+\.)+(com|cn|net|org)$/;

        if(myReg.test(email)){
            return true;
        }else{

            return false;
        }
    }
    layui.use(['laydate', 'form', 'layer', 'table', 'element'], function() {
        layer = layui.layer; //弹层
        $("#regBtn").click(function () {
            var username = $.trim($("#username").val());
            var password =$.trim($("#password").val());
            var confirmpassword =$.trim($("#confirmpassword").val());
            var email = $.trim($("#email").val());
            var invitecode = $.trim($("#invitecode").val());

            if (username.length < 1) {
                layer.msg('请输入正确格式的用户名');
                return false;

            }
           else if (email==''||!checkEmail(email)) {
                layer.msg('请输入正确的邮箱');
                return false;
            }
            else if (password.length < 6) {
                layer.msg('请输入正确格式的密码');
                return false;

            }
           
            else if (password!=confirmpassword) {
                layer.msg('两次密码输入不一致');
                return false;

            }
        
            if(invitecode!='')
            {
                var checkinvitecode=true;
                $.ajax({
                    type:'post',
                    async:false,
                    url:'user_Login_checkinvitecode.html',
                    data: { invitecode: invitecode},
                    dataType:'json',
                    success:function(result){
                        checkinvitecode=result['valid'];
                    }
                })
                if(checkinvitecode==false)
                {
                    layer.msg('激活码不正确');
                    return false;
                }
            }
          if (!$("[name='agreeBtn']").prop("checked")) {
            layer.msg("请查看协议！",{time:1500});
            return;
        }

            $.ajax({
                type:'post',
                url:'<{$register_checkRegister}>',
                data: { username: username, password: password, confirmpassword: confirmpassword,email:email,invitecode:invitecode},
                dataType:'json',
                success:function(result){
                    if(result['errorno'] == 0){

                        if(result['need_activate'] == 1) {
                            var TipsContent="<div style='padding: 50px; line-height: 22px; background-color: #393D49; color: #fff; font-weight: 300;'>" +
                                "<h3>恭喜您，注册成功！</h3>" +
                                "<p>我们已发送了一封验证邮件到 <strong>"+result['msg']['email']+"</strong>, 请注意查收您的邮箱，点击其中的链接激活您的账号！</p>" +
                                "<p>如果您未收到验证邮件，请联系管理员重新发送验证邮件或手动帮您激活账号。</p>"
                            "<br/><br/><a href='user_Login_index.html' style='color:#fff'>点击这里登录</a></div>";

                            layer.open({
                                type: 1,
                                title:'注册成功',
                                skin: 'layui-layer-rim', //加上边框
                                area: ['500px', '350px'], //宽高
                                content: TipsContent,
                                end: function () {
                                    setTimeout(function () {
                                        layer.msg('正在为您跳转到登录页面...');
                                        setTimeout(function() {
                                            window.location.href = "<{$siteurl}>" + "Home_Index_userLogin.html";
                                        },3000 );

                                    },2000);
                                }
                            });
                        } else {
                            layer.msg('注册成功！正在为您跳转到登录页面...');
                            setTimeout(function() {
                                window.location.href = "<{$siteurl}>" + "Home_Index_userLogin.html";
                            },3000 );
                        }
                    }else{
                        layer.msg(result['msg']);
                    }
                }
            })
        })
        $(document).keyup(function(event){
            if(event.keyCode ==13){
                $("#regBtn").trigger("click");
            }
        });
    });
</script>
  <script>

    //合作协议
    function showAgree() {
        layer.open({
            type: 2,
            title: '<{$sitename}>业务合作协议',
            area: ['900px', '500px'],
            content: 'Home_Index_agree.html',
            end: function () {

            }
        });
    }

</script>
</body>
</html>