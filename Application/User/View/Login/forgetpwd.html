<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>找回密码 - <{$sitename}></title>
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta content="A fully featured admin theme which can be used to build CRM, CMS, etc." name="description" />
<meta content="Coderthemes" name="author" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<!-- App favicon -->
<link rel="shortcut icon" href="/Public/assetsqq572125157/images/favicon.ico">
<!-- jvectormap -->
<link href="/Public/assetsqq572125157/libs/jqvmap/jqvmap.min.css" rel="stylesheet" />
<!-- DataTables -->
<link href="/Public/assetsqq572125157/libs/datatables.net-bs4/css/dataTables.bootstrap4.min.css" rel="stylesheet" type="text/css"/>
<link href="/Public/assetsqq572125157/libs/datatables.net-responsive-bs4/css/responsive.bootstrap4.min.css" rel="stylesheet" type="text/css"/>
<!-- Icons css -->
<link href="/Public/assetsqq572125157/libs/@mdi/font/css/materialdesignicons.min.css" rel="stylesheet" type="text/css" />
<link href="/Public/assetsqq572125157/libs/dripicons/webfont/webfont.css" rel="stylesheet" type="text/css" />
<link href="/Public/assetsqq572125157/libs/simple-line-icons/css/simple-line-icons.css" rel="stylesheet" type="text/css" />
<!-- App css -->
<!-- build:css -->
<link href="/Public/assetsqq572125157/css/app.css" rel="stylesheet" type="text/css" />
<link rel="stylesheet" href="/Public/Front/js/plugins/layui/css/layui.css">
<!-- endbuild -->
  <script type="text/javascript">
        if (top.location !== self.location) {
            top.location = self.location;
        }
    </script>
</head>
<body>

<body class="bg-account-pages">

        <!-- Login -->
        <section>
            <div class="container">
                <div class="row">
                    <div class="col-12">

                        <div class="wrapper-page">
                            <div class="account-pages">
                                <div class="account-box">

                                    <!-- Logo box-->
                                    <div class="account-logo-box">
                               <h2 class="text-uppercase text-center">
  <div class="button-list m-t-20">
                                <button type="button" class="btn btn-light" data-container="body" title="" data-toggle="tooltip" data-placement="bottom" title="" data-original-title="<{$sitename}>，专业支付技术服务商    让支付简单、专业、快捷！" >
                           找回密码 - <{$sitename}>
                                </button>
  </div>
                                     </h2>
                                    </div>

                                    <div class="account-content">
                                      <form class="form bordered-input" id="formlogin" name="formlogin" method="post" role="form" action="<{:U("Login/forgetpwd")}>">
                                         <div class="form-group">

                                                <label for="emailaddress" class="font-weight-medium">用户名</label>
                                                <input class="form-control" type="text" id="username" name="username" required="required" placeholder="输入用户名，注意非商户ID">
                                            </div>

                                     
                                         
                                      
                                         
                                  <div class="form-group">
                                                <label for="emailaddress" class="font-weight-medium">电子邮件</label>
  <input class="form-control" type="text"  required="required" name="email"  id="email" placeholder="请输入绑定的邮箱地址">
                                            </div>
                                         
                                           <div class="form-group">

                                                <label for="password" class="font-weight-medium">新密码</label>
                                                <input class="form-control" type="password" required="required" id="password" name="password"  placeholder="请输入密码">
                                            </div>
                                        
                                        
                                          <div class="form-group">

                                                <label for="password" class="font-weight-medium">确认密码</label>
                                                <input class="form-control" type="password"  required="required"   id="confirmpassword" name="confirmpassword"  placeholder="请再次输入密码">         
                                            </div>
                                         <if condition="$siteconfig['invitecode'] eq 1">
                                             <div class="form-group">
                                          <div class="input-group">
                                                <input class="form-control" type="text" id="verification" name="varification" required="required" placeholder="填写电子邮件接收到的验证码">
 <div class="input-group-append">
                    <button type="button" class="btn btn-danger waves-effect waves-light" id="btnGet" data-toggle="tooltip" data-placement="top" title="" data-original-title="点击发送邮件验证码"><i class="mdi mdi-angular"></i> 发送验证码</button>
</div>
                                            </div></div>
                                           </if>
                                         
                                            
                                         
                                         
                                  


                                            <div class="form-group row text-center">
                                                <div class="col-12">
                                                    <button class="btn btn-block btn-success waves-effect waves-light"   type="button"><i class="mdi mdi-home mr-1"></i> 提交</button>
                                                </div>
                                            </div>
                                        </form> <!-- end form -->

                                        <div class="row mt-3">
                                            <div class="col-12 text-center">
                                                <p class="text-muted">记得账号密码? <a href="<{:U("Login/index")}>" class="text-dark m-l-5"><b>立即登录</b></a></p>
                                            </div>
                                        </div> <!-- end row-->
                                    </div> <!-- end account-content -->

                                </div> <!-- end account-box -->
                            </div>
                            <!-- end account-page-->
                        </div>
                        <!-- end wrapper-page -->

                    </div> <!-- end col -->
                </div> <!-- end row -->
            </div> <!-- end container -->
        </section>
        <!-- END HOME -->    
<!-- ============================================================== -->
<script src="Public/New/plugins/vendors/jquery/jquery.min.js"></script>
<!-- Bootstrap popper Core JavaScript -->
<script src="Public/New/plugins/vendors/bootstrap/js/popper.min.js"></script>
<script src="Public/New/plugins/vendors/bootstrap/js/bootstrap.min.js"></script>
<!-- slimscrollbar scrollbar JavaScript -->
<script src="Public/New/plugins/vendors/ps/perfect-scrollbar.jquery.min.js"></script>
<!--Menu sidebar -->
<script src="Public/New/assets/js/sidebarmenu.js"></script>
<!--Custom JavaScript -->
<script src="Public/New/assets/js/custom.min.js"></script>
<script src="Public/Front/js/plugins/layui/layui.js" charset="utf-8"></script>
<script src="Public/Front/bootstrapvalidator/js/bootstrapValidator.min.js"></script>
<script src="Public/Front/js/plugins/zxcvbn/4.4.2/zxcvbn.js"></script>
<script src="Public/Front/js/plugins/layer/layer.min.js"></script>
<script src="Public/Front/login/js/modernizr-2.6.2.min.js"></script>
<script>
    var isSend=false;
    $("#btnGet").on("click",function(){
        if(isSend)
            return;
        var obj=this;
        var username=$("#username").val();
        var email=$("#email").val();
        if(username=="")
        {
            layer.msg('请输入用户名！');
            return ;
        }
        if(email=="")
        {
            layer.msg('请输入邮箱！');
            return ;
        }
        isSend=true;
        $.ajax({
            url:"<{:U('User/Login/sendUserCode')}>",
            type:"post",
            data:{'username':username,'email':email},
            success:function(res){
                if(res.status){
                    settime(obj)
                    isSend=true;
                    layer.alert("发送成功", {icon: 6});
                }else{
                    isSend=false;
                    layer.msg(res.msg ? res.msg : "操作失败!", {icon: 5}
                    );
                    return false;
                }

            }
        });

    });
    //短信后倒计时
    var countdown=60;
    function settime(obj) {
        if (countdown == 0) {
            $(obj).attr("disabled",false);
            isSend=false;
            $(obj).html("获取验证码");
            countdown = 60;
            return;
        } else {
            $(obj).attr("disabled", true);
            isSend=true;
            $(obj).html("重新发送(" + countdown + ")");
            countdown--;
        }
        setTimeout(function() {
                settime(obj) }
            ,1000)
    }
    $(document).ready(function() {
        $('form').bootstrapValidator({
            //container: '#messages',
            message: 'This value is not valid',
            feedbackIcons: {
                valid: 'glyphicon glyphicon-ok',
                invalid: 'glyphicon glyphicon-remove',
                validating: 'glyphicon glyphicon-refresh'
            },
            fields: {
                username: {
                    message: '<div class="col-12">用户名验证失败</div>',
                    validators: {
                        notEmpty: {
                            message: '<div class="col-12">用户名不能为空</div>'
                        },
                      
                    }
                },
                password: {
                    validators: {
                        notEmpty: {
                            message: '<div class="col-12">密码不能为空</div>'
                        },
                        identical: {
                            field: 'confirmpassword',
                            message: '<div class="col-12">两次密码不一致</div>'
                        },
                        different: {
                            field: 'username',
                            message: '<div class="col-12">不能和用户名相同</div>'
                        },
                        stringLength: {
                            min: 6,
                            max: 30,
                            message: '<div class="col-12">密码长度在6到30之间</div>'
                        }
                    }
                },
                confirmpassword: {
                    message: '<div class="col-12">确认密码无效</div>',
                    validators: {
                        notEmpty: {
                            message: '<div class="col-12">确认密码不能为空</div>'
                        },
                        stringLength: {
                            min: 6,
                            max: 30,
                            message: '<div class="col-12">密码长度在6到30之间</div>'
                        },
                        identical: {
                            field: 'password',
                            message: '<div class="col-12">两次密码不一致</div>'
                        },
                        different: {
                            field: 'username',
                            message: '<div class="col-12">不能和用户名相同</div>'
                        }
                    }
                },
                email: {
                    message: '<div class="col-12">邮件验证失败</div>',
                    validators: {
                        notEmpty: {
                            message: '<div class="col-12">邮件不能为空</div>'
                        },

                        regexp:{
                            regexp:/^(\w)+(\.\w+)*@(\w)+((\.\w+)+)$/,
                            message: '<div class="col-12">邮件格式有误，请核对</div>'
                        }
                    }
                }
            }
        }).on('success.form.bv', function(e) {
            e.preventDefault();
            var $form = $(e.target);
            var bv = $form.data('bootstrapValidator');
            $.post($form.attr('action'), $form.serialize(), function(res) {
                if(res.status){
                    layer.alert("修改成功", {icon: 6},function () {
                        window.location.href="<{:U('Login/index')}>";
                    });
                }else{
                    layer.msg(res.msg ? res.msg : "修改失败!", {icon: 5},function () {
                            window.location.reload();
                        }
                    );
                }
            }, 'json');
        });
    });
</script>
</body>
</html>